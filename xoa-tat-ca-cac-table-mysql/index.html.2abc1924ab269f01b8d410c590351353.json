{"head":{"layout":"Post","title":"Xóa tất cả table trong database MySQL","date":"2015-03-15T08:00:00.000Z","description":"MySQL Procedure giúp xóa nhanh tất cả table trong 1 database","tags":["mysql"],"toc":false},"body":"<p>Nếu bạn đang dùng mysql command line để quản lí database (nhất là khi sử dụng VPS...) thì bạn sẽ biết rằng MySQL không hỗ trợ việc xóa tất cả table. Cách thường được dùng đó là xóa hẳn database và tạo database mới. Việc này khá tốn thời gian và cần dùng đến 3 câu query dài để thực hiện (gồm xóa, tạo database, cấp quyền cho user).</p>\n<p>Mình có tìm được đoạn code ngắn này mời các bạn tham khảo:</p>\n<pre><code class=\"hljs language-mysql\">DELIMITER $$\n\n<span class=\"hljs-keyword\">DROP</span> <span class=\"hljs-keyword\">PROCEDURE</span> <span class=\"hljs-keyword\">IF</span> <span class=\"hljs-keyword\">EXISTS</span> <span class=\"hljs-string\">`drop_all_tables_from`</span> $$\n\n<span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">PROCEDURE</span> <span class=\"hljs-string\">`drop_all_tables_from`</span>(<span class=\"hljs-keyword\">IN</span> schema_target <span class=\"hljs-built_in\">VARCHAR</span>(<span class=\"hljs-number\">128</span>))\n<span class=\"hljs-keyword\">BEGIN</span>\n    <span class=\"hljs-keyword\">DECLARE</span> table_list <span class=\"hljs-built_in\">TEXT</span>;\n\n    <span class=\"hljs-keyword\">SELECT</span>\n        <span class=\"hljs-keyword\">GROUP_CONCAT</span>(<span class=\"hljs-string\">`TABLE_NAME`</span>)\n    <span class=\"hljs-keyword\">INTO</span>\n        table_list\n\n    <span class=\"hljs-keyword\">FROM</span> <span class=\"hljs-string\">`information_schema`</span>.<span class=\"hljs-string\">`TABLES`</span>\n    <span class=\"hljs-keyword\">WHERE</span>\n          <span class=\"hljs-string\">`TABLE_SCHEMA`</span> = schema_target;\n\n    IF table_list IS NOT NULL THEN\n        <span class=\"hljs-keyword\">SET</span> @drop_tables = <span class=\"hljs-keyword\">CONCAT</span>(<span class=\"hljs-string\">\"DROP TABLE \"</span>, table_list);\n\n        <span class=\"hljs-keyword\">PREPARE</span> stmt <span class=\"hljs-keyword\">FROM</span> @drop_tables;\n        <span class=\"hljs-keyword\">EXECUTE</span> stmt;\n        <span class=\"hljs-keyword\">DEALLOCATE</span> <span class=\"hljs-keyword\">PREPARE</span> stmt;\n    <span class=\"hljs-keyword\">END</span> <span class=\"hljs-keyword\">IF</span>;\n\n<span class=\"hljs-keyword\">END</span> $$\n\nDELIMITER ;</code></pre>\n<p>Sử dụng đơn giản bằng các gọi lệnh sau, thay database_name bằng tên phù hợp</p>\n<pre><code class=\"hljs language-mysql\"><span class=\"hljs-keyword\">CALL</span> drop_all_tables_from(<span class=\"hljs-string\">\"database_name\"</span>);</code></pre>\n<p><strong>Lưu ý:</strong> Lệnh trên sẽ xóa mọi table trong database mà không hề có bất cứ cảnh báo hay xác nhận nào. Sử dụng cẩn thận.</p>\n<p>Nguồn: <a href=\"http://dor.ky/mysql-procedure-drop-all-tables-in-database/\">dor.ky</a></p>\n","__filename":"xoa-tat-ca-cac-table-mysql.md","__url":"/xoa-tat-ca-cac-table-mysql/","__resourceUrl":"/xoa-tat-ca-cac-table-mysql/index.html","__dataUrl":"/xoa-tat-ca-cac-table-mysql/index.html.2abc1924ab269f01b8d410c590351353.json"}