{"head":{"layout":"Post","title":"Xóa tất cả table trong database MySQL","date":"2015-03-15T08:00:00.000Z","description":"MySQL Procedure giúp xóa nhanh tất cả table trong 1 database","tags":["mysql"],"toc":false},"body":"<p>Nếu bạn đang dùng mysql command line để quản lí database (nhất là khi sử dụng VPS…) thì bạn sẽ biết rằng MySQL không hỗ trợ việc xóa tất cả table. Cách thường được dùng đó là xóa hẳn database và tạo database mới. Việc này khá tốn thời gian và cần dùng đến 3 câu query dài để thực hiện (gồm xóa, tạo database, cấp quyền cho user).</p>\n<p>Mình có tìm được đoạn code ngắn này mời các bạn tham khảo:</p>\n<pre><code class=\"language-mysql\">DELIMITER $$\n\n<span class=\"hljs-keyword\">DROP</span> <span class=\"hljs-keyword\">PROCEDURE</span> <span class=\"hljs-keyword\">IF</span> <span class=\"hljs-keyword\">EXISTS</span> <span class=\"hljs-string\">`drop_all_tables_from`</span> $$\n\n<span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">PROCEDURE</span> <span class=\"hljs-string\">`drop_all_tables_from`</span>(<span class=\"hljs-keyword\">IN</span> schema_target <span class=\"hljs-built_in\">VARCHAR</span>(<span class=\"hljs-number\">128</span>))\n<span class=\"hljs-keyword\">BEGIN</span>\n    <span class=\"hljs-keyword\">DECLARE</span> table_list <span class=\"hljs-built_in\">TEXT</span>;\n\n    <span class=\"hljs-keyword\">SELECT</span>\n        <span class=\"hljs-keyword\">GROUP_CONCAT</span>(<span class=\"hljs-string\">`TABLE_NAME`</span>)\n    <span class=\"hljs-keyword\">INTO</span>\n        table_list\n\n    <span class=\"hljs-keyword\">FROM</span> <span class=\"hljs-string\">`information_schema`</span>.<span class=\"hljs-string\">`TABLES`</span>\n    <span class=\"hljs-keyword\">WHERE</span>\n          <span class=\"hljs-string\">`TABLE_SCHEMA`</span> = schema_target;\n\n    IF table_list IS NOT NULL THEN\n        <span class=\"hljs-keyword\">SET</span> @drop_tables = <span class=\"hljs-keyword\">CONCAT</span>(<span class=\"hljs-string\">\"DROP TABLE \"</span>, table_list);\n\n        <span class=\"hljs-keyword\">PREPARE</span> stmt <span class=\"hljs-keyword\">FROM</span> @drop_tables;\n        <span class=\"hljs-keyword\">EXECUTE</span> stmt;\n        <span class=\"hljs-keyword\">DEALLOCATE</span> <span class=\"hljs-keyword\">PREPARE</span> stmt;\n    <span class=\"hljs-keyword\">END</span> <span class=\"hljs-keyword\">IF</span>;\n\n<span class=\"hljs-keyword\">END</span> $$\n\nDELIMITER ;</code></pre>\n<p>Sử dụng đơn giản bằng các gọi lệnh sau, thay database_name bằng tên phù hợp</p>\n<pre><code class=\"language-mysql\"><span class=\"hljs-keyword\">CALL</span> drop_all_tables_from(<span class=\"hljs-string\">\"database_name\"</span>);</code></pre>\n<p><strong>Lưu ý:</strong> Lệnh trên sẽ xóa mọi table trong database mà không hề có bất cứ cảnh báo hay xác nhận nào. Sử dụng cẩn thận.</p>\n<p>Nguồn: <a href=\"http://dor.ky/mysql-procedure-drop-all-tables-in-database/\">dor.ky</a></p>\n","rawBody":"\nNếu bạn đang dùng mysql command line để quản lí database (nhất là khi sử dụng VPS...) thì bạn sẽ biết rằng MySQL không hỗ trợ việc xóa tất cả table. Cách thường được dùng đó là xóa hẳn database và tạo database mới. Việc này khá tốn thời gian và cần dùng đến 3 câu query dài để thực hiện (gồm xóa, tạo database, cấp quyền cho user).\n\nMình có tìm được đoạn code ngắn này mời các bạn tham khảo:\n\n```mysql\nDELIMITER $$\n\nDROP PROCEDURE IF EXISTS `drop_all_tables_from` $$\n\nCREATE PROCEDURE `drop_all_tables_from`(IN schema_target VARCHAR(128))\nBEGIN\n    DECLARE table_list TEXT;\n\n    SELECT\n        GROUP_CONCAT(`TABLE_NAME`)\n    INTO\n        table_list\n\n    FROM `information_schema`.`TABLES`\n    WHERE\n          `TABLE_SCHEMA` = schema_target;\n\n    IF table_list IS NOT NULL THEN\n        SET @drop_tables = CONCAT(\"DROP TABLE \", table_list);\n\n        PREPARE stmt FROM @drop_tables;\n        EXECUTE stmt;\n        DEALLOCATE PREPARE stmt;\n    END IF;\n\nEND $$\n\nDELIMITER ;\n```\n\nSử dụng đơn giản bằng các gọi lệnh sau, thay database_name bằng tên phù hợp\n\n```mysql\nCALL drop_all_tables_from(\"database_name\");\n```\n\n**Lưu ý:** Lệnh trên sẽ xóa mọi table trong database mà không hề có bất cứ cảnh báo hay xác nhận nào. Sử dụng cẩn thận.\n\nNguồn: [dor.ky](http://dor.ky/mysql-procedure-drop-all-tables-in-database/)\n","raw":"---\nlayout: Post\ntitle: 'Xóa tất cả table trong database MySQL'\ndate: 2015-03-15 08:00:00\ndescription: 'MySQL Procedure giúp xóa nhanh tất cả table trong 1 database'\ntags: [mysql]\ntoc: false\n---\n\nNếu bạn đang dùng mysql command line để quản lí database (nhất là khi sử dụng VPS...) thì bạn sẽ biết rằng MySQL không hỗ trợ việc xóa tất cả table. Cách thường được dùng đó là xóa hẳn database và tạo database mới. Việc này khá tốn thời gian và cần dùng đến 3 câu query dài để thực hiện (gồm xóa, tạo database, cấp quyền cho user).\n\nMình có tìm được đoạn code ngắn này mời các bạn tham khảo:\n\n```mysql\nDELIMITER $$\n\nDROP PROCEDURE IF EXISTS `drop_all_tables_from` $$\n\nCREATE PROCEDURE `drop_all_tables_from`(IN schema_target VARCHAR(128))\nBEGIN\n    DECLARE table_list TEXT;\n\n    SELECT\n        GROUP_CONCAT(`TABLE_NAME`)\n    INTO\n        table_list\n\n    FROM `information_schema`.`TABLES`\n    WHERE\n          `TABLE_SCHEMA` = schema_target;\n\n    IF table_list IS NOT NULL THEN\n        SET @drop_tables = CONCAT(\"DROP TABLE \", table_list);\n\n        PREPARE stmt FROM @drop_tables;\n        EXECUTE stmt;\n        DEALLOCATE PREPARE stmt;\n    END IF;\n\nEND $$\n\nDELIMITER ;\n```\n\nSử dụng đơn giản bằng các gọi lệnh sau, thay database_name bằng tên phù hợp\n\n```mysql\nCALL drop_all_tables_from(\"database_name\");\n```\n\n**Lưu ý:** Lệnh trên sẽ xóa mọi table trong database mà không hề có bất cứ cảnh báo hay xác nhận nào. Sử dụng cẩn thận.\n\nNguồn: [dor.ky](http://dor.ky/mysql-procedure-drop-all-tables-in-database/)\n","__filename":"xoa-tat-ca-cac-table-mysql.md","__url":"/xoa-tat-ca-cac-table-mysql/","__resourceUrl":"/xoa-tat-ca-cac-table-mysql/index.html","__dataUrl":"/xoa-tat-ca-cac-table-mysql/index.html.1d5c817823da676285785c5e3d227071.json"}