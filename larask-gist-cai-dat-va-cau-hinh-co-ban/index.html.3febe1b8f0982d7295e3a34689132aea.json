{"head":{"layout":"Post","title":"Cài đặt và thiết lập cơ bản cho Larask Gist","date":"2015-03-12T18:00:00.000Z","description":"Hướng dẫn cài đặt Laravel 5 và thiết lập cơ bản cho ứng dụng","tags":["laravel"]},"body":"<p>Đây là bài viết trong <a href=\"/gioi-thieu-series-larask-gist/\">series Larask Gist</a>.\nToàn bộ source code của bài viết này bạn có thể xem tại đây: <a href=\"https://github.com/Larask/gist/\">Larask Gist</a></p>\n<h1 id=\"cài-đặt\"><a href=\"#c%C3%A0i-%C4%91%E1%BA%B7t\" class=\"phenomic-HeadingAnchor\">#</a>Cài đặt</h1>\n<p>Trong series này mình sẽ dùng Laragon để hướng dẫn. Vì vậy nếu bạn nào chưa cài đặt Laragon hãy <a href=\"/laragon-cai-dat-laravel-trong-mot-phut/\">cài đặt ngay theo hướng dẫn</a>. (nếu máy bạn đủ khả năng ảo hóa, hãy sử dụng Homestead thay thế)</p>\n<p>Dùng Laragon tạo một project mới tên là <code>gist</code>. Chờ để Laragon (thực tế là composer) tải và cài đặt Laravel. Mở trình duyệt và truy cập vào <code>gist.dev</code>. Nếu xuất hiện màn hinh chào mừng của Laravel là bạn đã thành công.</p>\n<p><img src=\"/images/2015-12-03-larask-gist-cai-dat-va-cau-hinh-co-ban/welcome-laravel.jpg\" alt=\"Welcome to Laravel\"></p>\n<h1 id=\"cấu-hình-cơ-bản\"><a href=\"#c%E1%BA%A5u-h%C3%ACnh-c%C6%A1-b%E1%BA%A3n\" class=\"phenomic-HeadingAnchor\">#</a>Cấu hình cơ bản</h1>\n<h2 id=\"Đổi-tên-app-namespace\"><a href=\"#%C4%90%E1%BB%95i-t%C3%AAn-app-namespace\" class=\"phenomic-HeadingAnchor\">#</a>Đổi tên app (namespace)</h2>\n<p>Việc đầu tiên cần làm sau khi cài ứng dụng là đổi tên. Thay vì sử dụng tên mặc định là <code>App</code> chúng ta sẽ đổi nó thành <code>Gist</code></p>\n<pre><code class=\"hljs language-shell\">php artisan app:<span class=\"hljs-built_in\">name</span> Gist</code></pre>\n<pre><code class=\"hljs language-shell\">Application <span class=\"hljs-built_in\">name</span> <span class=\"hljs-keyword\">set</span>!</code></pre>\n<p>Từ bây giờ, toàn bộ ứng dụng của chúng ta sẽ có namespace là <code>Gist</code></p>\n<h3 id=\"cấu-hình-các-thông-số\"><a href=\"#c%E1%BA%A5u-h%C3%ACnh-c%C3%A1c-th%C3%B4ng-s%E1%BB%91\" class=\"phenomic-HeadingAnchor\">#</a>Cấu hình các thông số</h3>\n<p>Ngày nay, git là version control thông dụng. Và bạn sẽ không muốn các thông tin như cấu hình database, mật khẩu, API key được công khai (ví dụ trên Github hay Bitbucket khi push code). Và bạn cũng không muốn phải sửa các thông số này thường xuyên khi deploy ứng dụng do sự khác nhau giữa các môi trường làm việc (ví dụ local và production).</p>\n<p>Laravel tích hợp sẵn <code>.dotenv</code> để giúp bạn làm thực hiện việc này dễ dàng nhất. Mỗi mỗi trường sẽ có 1 file <code>.env</code> ở thư mục gốc lưu các thông tin quan trọng.</p>\n<p>Cách hoạt động của file <code>.env</code> rất đơn giản. Hãy mở file <code>/config/database.php</code> các bạn sẽ thấy dòng này :</p>\n<pre><code class=\"hljs language-php\"><span class=\"hljs-string\">'mysql'</span> => [\n  <span class=\"hljs-string\">'driver'</span>    => <span class=\"hljs-string\">'mysql'</span>,\n  <span class=\"hljs-string\">'host'</span>      => env(<span class=\"hljs-string\">'DB_HOST'</span>, <span class=\"hljs-string\">'localhost'</span>),\n  <span class=\"hljs-string\">'database'</span>  => env(<span class=\"hljs-string\">'DB_DATABASE'</span>, <span class=\"hljs-string\">'forge'</span>),\n  <span class=\"hljs-string\">'username'</span>  => env(<span class=\"hljs-string\">'DB_USERNAME'</span>, <span class=\"hljs-string\">'forge'</span>),\n  <span class=\"hljs-string\">'password'</span>  => env(<span class=\"hljs-string\">'DB_PASSWORD'</span>, <span class=\"hljs-string\">''</span>),\n  <span class=\"hljs-string\">'charset'</span>   => <span class=\"hljs-string\">'utf8'</span>,\n  <span class=\"hljs-string\">'collation'</span> => <span class=\"hljs-string\">'utf8_unicode_ci'</span>,\n  <span class=\"hljs-string\">'prefix'</span>    => <span class=\"hljs-string\">''</span>,\n  <span class=\"hljs-string\">'strict'</span>    => <span class=\"hljs-keyword\">false</span>,\n],</code></pre>\n<p>File <code>.env</code> đi kèm sau khi cài Laravel thành công sẽ có nội dung như sau:</p>\n<pre><code class=\"hljs language-shell\"><span class=\"hljs-attr\">APP_ENV</span>=local\n<span class=\"hljs-attr\">APP_DEBUG</span>=<span class=\"hljs-literal\">true</span>\n<span class=\"hljs-attr\">APP_KEY</span>=rTPeTeKYrhiu61RyvFeyGkbZF2KS2Fe2\n\n<span class=\"hljs-attr\">DB_HOST</span>=localhost\n<span class=\"hljs-attr\">DB_DATABASE</span>=homestead\n<span class=\"hljs-attr\">DB_USERNAME</span>=homestead\n<span class=\"hljs-attr\">DB_PASSWORD</span>=secret\n\n<span class=\"hljs-attr\">CACHE_DRIVER</span>=file\n<span class=\"hljs-attr\">SESSION_DRIVER</span>=file</code></pre>\n<p><em>Lưu ý: Luôn luôn giữ bí mật APP_KEY của bạn</em></p>\n<p>Laravel dùng hàm <code>env('DB_HOST', 'localhost')</code> để lấy giá trị <code>DB_HOST</code> trong file <code>.env</code>. Nếu không có giá trị này,  giá trị mặc định là <code>localhost</code> sẽ được dùng. Các bạn có thể bỏ trống biến thứ 2 của hàm <code>env</code> và khi đó giá trị mặc định trả về sẽ là <code>null</code></p>\n<pre><code class=\"hljs language-php\"><span class=\"hljs-comment\">/**\n * Gets the value of an environment variable. Supports boolean, empty and null.\n *\n * <span class=\"hljs-doctag\">@param</span>  string  $key\n * <span class=\"hljs-doctag\">@param</span>  mixed   $default\n * <span class=\"hljs-doctag\">@return</span> mixed\n */</span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">env</span><span class=\"hljs-params\">($key, $default = null)</span> </span>{\n  <span class=\"hljs-comment\">// some thing here</span>\n}</code></pre>\n<p>Trong file <code>.env</code> chúng ta sẽ cấu hình các mục</p>\n<pre><code class=\"hljs language-shell\"><span class=\"hljs-attr\">DB_HOST</span>=localhost\n<span class=\"hljs-attr\">DB_DATABASE</span>=gist\n<span class=\"hljs-attr\">DB_USERNAME</span>=root\n<span class=\"hljs-attr\">DB_PASSWORD</span>=</code></pre>\n<p>Phù hợp với cấu hình mysql của bạn. (nếu bạn sử dụng PostgreSQL, SQLite,...) Hãy thay đổi <code>default</code> cho phù hợp trong <code>config/database.php</code></p>\n<p>Kiểm tra kết nối database thành công bằng cách chạy lệnh sau vào Cmder</p>\n<pre><code class=\"hljs language-shell\">php artisan tinker\n<span class=\"hljs-meta\">>></span>> DB::Statement(<span class=\"hljs-string\">\"SHOW TABLES\"</span>)\n<span class=\"hljs-literal\">true</span></code></pre>\n<p><em>Lưu ý: <code>SHOW TABLES</code> là câu lệnh của MySQL để hiển thị tất cả table trong database hiện tại (gist), nếu các bạn sử dụng các loại database khác. Câu lệnh này phải được thay đổi cho phù hợp</em></p>\n<pre><code class=\"hljs language-php\">DB::Statement($command)</code></pre>\n<p>Dùng để chạy một câu query.</p>\n<h3 id=\"cài-ide-helper-package\"><a href=\"#c%C3%A0i-ide-helper-package\" class=\"phenomic-HeadingAnchor\">#</a>Cài ide-helper package</h3>\n<p>Để các IDE có thể \"hiểu\" được những gì chúng ta đang code và có các type hint thì chúng ta cần cài package hỗ trợ. Ở đây mình sẽ dùng <a href=\"https://github.com/barryvdh/laravel-ide-helper\">barryvdh/laravel-ide-helper</a> .</p>\n<p>Trong Cmder:</p>\n<pre><code class=\"hljs language-shell\"><span class=\"hljs-symbol\">composer</span> <span class=\"hljs-meta\">require</span> <span class=\"hljs-keyword\">barryvdh/laravel-ide-helper </span>--dev</code></pre>\n<p>Option --dev để composer hiểu chúng ta chỉ cần package này khi develop.</p>\n<p>Mở file <code>'Gist\\Providers\\AppServiceProvider'</code> trong method <code>register()</code> chúng ta sẽ thêm vào :</p>\n<pre><code class=\"hljs language-php\"><span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">$this</span>->app->environment() == <span class=\"hljs-string\">'local'</span>) {\n  <span class=\"hljs-keyword\">$this</span>->app->register(<span class=\"hljs-string\">'Barryvdh\\LaravelIdeHelper\\IdeHelperServiceProvider'</span>);\n}</code></pre>\n<p>Tiếp tục trong Cmder:</p>\n<pre><code class=\"hljs language-shell\">php artisan ide-helper:<span class=\"hljs-keyword\">generate</span></code></pre>\n<p>Lệnh trên sẽ tạo file _ide_helpers.php trong thư mục gốc giúp các IDE có thể hiểu được Laravel.\nBạn cần phải chạy lệnh trên mỗi lần cài đặt thêm package mới.\nNhưng bạn cài đặt package bằng Composer phải không?\nHãy để Composer làm điểu đó cho bạn.</p>\n<p>Mở file <code>composer.json</code> và sửa <code>post-update-cmd</code> giống như bạn dưới (chính xác thứ tự các dòng nhé)</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-string\">\"post-update-cmd\"</span>:[\n  <span class=\"hljs-string\">\"php artisan clear-compiled\"</span>,\n  <span class=\"hljs-string\">\"php artisan ide-helper:generate\"</span>,\n  <span class=\"hljs-string\">\"php artisan optimize\"</span>\n]</code></pre>\n<p>Cuối cùng là add file <code>_ide_helper.php</code> vào cuối file <code>.gitignore</code>  để cho git không theo dõi file này, tránh các rắc rối về commit/merge về sau.</p>\n<h1 id=\"kết-luận\"><a href=\"#k%E1%BA%BFt-lu%E1%BA%ADn\" class=\"phenomic-HeadingAnchor\">#</a>Kết luận</h1>\n<p>Nếu bạn đọc được đến đây thì bạn đã sẵn sàng để chinh phục Laravel rồi đấy.</p>\n","__filename":"larask-gist-cai-dat-va-cau-hinh-co-ban.md","__url":"/larask-gist-cai-dat-va-cau-hinh-co-ban/","__resourceUrl":"/larask-gist-cai-dat-va-cau-hinh-co-ban/index.html","__dataUrl":"/larask-gist-cai-dat-va-cau-hinh-co-ban/index.html.3febe1b8f0982d7295e3a34689132aea.json"}